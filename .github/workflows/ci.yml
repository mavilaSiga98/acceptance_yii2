on:
  - pull_request
  - push

name: CI

jobs:
  Ci_simple:
    runs-on: ubuntu-latest
          
    services:
      selenium:
        image: selenium/standalone-chrome:latest
        ports: 
          - 4444:4444
        options: --shm-size="2g"

    steps:
      - name: Checkout
        uses: actions/checkout@v2

      - name: Install dependencies with composer php
        run: composer update --prefer-dist --no-interaction --no-progress --optimize-autoloader --ansi



      - name: ☁ Install Selenium
        run: |
          npm install selenium-standalone -g
          selenium-standalone install

      - name: Run chromedriver
        run:  nohup $CHROMEWEBDRIVER/chromedriver --url-base=/wd/hub /dev/null 2>&1 &


      - name: Run tests with codeception
        run: |
          vendor/bin/codecept run
        shell: bash
